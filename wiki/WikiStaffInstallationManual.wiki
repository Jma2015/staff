#summary Installation, configuration and test guide

= Introduction =

It's a little guide for compiling and installing Staff on Linux-like OS.

= Details =

== 1. Compile and install dependencies ==

You need axis2/c-1.5.0 to be installed. Please refer to http://ws.apache.org/axis2/c/download.cgi.


== 2. Getting source code ==

Please refer to http://code.google.com/p/staff/source/checkout to read guide for getting source code from svn repository.

== 3. Compiling source code ==

=== 3.1 Compiling and installing rise ===

Enter these commands to compile and install rise from checkout root (staff-read-only):

{{{
make -C rise && sudo make -C rise install
}}}

=== 3.2 Compiling and installing staff ===

Enter these commands to compile and install staff from checkout root (staff-read-only):

{{{
export AXIS2C_HOME=<path to axis2/c installation dir> #example: /usr/local/axis2c
export STAFF_HOME=<path to staff installation dir> #example: /usr/local/staff
make -C staff && sudo make -C staff install
}}}

Make sure that postgres is runnung and enter
{{{
make -C staff/core/security installdb
}}}


== 4. Configuring ==

=== 4.1 Configuring axis2 ===

{{{
sudo mcedit $AXIS2C_HOME/axis2.xml
}}}

after line:
{{{
    <module ref="addressing"/>
}}}

add two lines:
{{{
<module ref="staff"/>
<module ref="staff_security"/>
}}}


=== 4.2 Configuring staff db connection ===

sudo mcedit $AXIS2C_HOME/modules/staff_security/module.xml

edit following parameters:
{{{
<parameter name="pgHost" locked="false">localhost</parameter>
<parameter name="pgPort" locked="false">5432</parameter>
<parameter name="pgUser" locked="false">POSTGRES_USER</parameter>
<parameter name="pgPassword" locked="false">POSTGRES_PASSWORD</parameter>
}}}


== 5. Starting ==

=== 5.1 Environment Variables == 
While starting axis2/c or any client/service application, these environment variables must be set:
{{{
AXIS2C_HOME=<path to axis2/c installation dir> #example: /usr/local/axis2c
STAFF_HOME=<path to staff installation dir> #example: /usr/local/staff
}}}

You can append there variables into ~/.bashrc file

=== 5.2 Starting in normal mode ===

{{{
cd $AXIS2C_HOME/bin
./axis2_http_server
}}}

=== 5.3 Starting in debug mode == 
{{{
cd $AXIS2C_HOME/bin
RISE_LOG_LEVEL=DEBUG3 RISE_EXCEPTION_STACKTRACING=1 ./axis2_http_server
}}}

== 6. Testing ==

=== 6.1 Basic test ===

Open Your favorite web-browser and enter:

http://localhost:9090/axis2/services

Services "StaffService" and "staff.Login" must running.

Sample services "calc.CalcService", "calc.SubService" must running.


=== 6.2 Service-Client test ===

Start service Calculator
{{{
calculator_service
}}}

From another console start client
{{{
calc_client
}}}